<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Sesli Market Asistanı (AI Destekli)</title>
</head>
<body>
  <h2>🛒 Sepetiniz</h2>
  <ul id="cart"></ul>

  <button id="startBtn">🎙️ Konuşmaya Başla</button>

  <script>
// --- Türkçe harfleri normalize et ---
function normalizeTurkish(text) {
  const map = {
    "ç": "c",
    "ğ": "g",
    "ı": "i",
    "ö": "o",
    "ş": "s",
    "ü": "u",
  };
  let normalized = text.toLowerCase();
  normalized = normalized.replace(/[çğışöü]/g, char => map[char] || char);
  return normalized;
}

// --- Sesli komut geldiğinde çalışacak ---
recognition.onresult = async (event) => {
  let transcript = event.results[event.resultIndex][0].transcript.trim();

  console.log("🎙️ Kullanıcı dedi ki:", transcript);

  // Normalizasyon burada olacak
  const normalizedTranscript = normalizeTurkish(transcript);
  console.log("✅ Normalize Edildi:", normalizedTranscript);

  try {
    await processCommand(normalizedTranscript);
  } catch (err) {
    console.error("Komut işlenemedi:", err);
    speak("Sistem hatası oldu Ayşe teyze, tekrar deneyiniz.");
  }
};
</script>

</body>

</html>
